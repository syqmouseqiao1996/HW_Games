<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link rel="stylesheet" href="stylesheets/styles.css">
    <title>計算機</title>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col">
                <button id="dark-light" type="button" class="btn btn-light">Dark</button>
            </div>
        </div>
        <div class="row">
            <div class="col">
                <div class="h4 mb-0 my-2" id="ST"></div>
            </div>
        </div>
        <div class="row">
            <div class="col ">
                <div class="">
                    <input id="cul-read" class="form-control text-right texth mb-3 bg-light text-dark ert" type="text"
                        placeholder="0" value="0" readonly>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col my-2"><a class="btn btn-light bta" id="PC">
                    <h2 class="h3">%</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta" id="clearInput">
                    <h2 class="h3">C</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta" id="delete">
                    <h2 class="h3">del</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta operator" id="divi">
                    <h2 class="h3">/</h2>
                </a></div>
        </div>
        <div class="row">
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">7</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">8</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">9</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta operator" id="mul">
                    <h2 class="h3">x</h2>
                </a></div>
        </div>
        <div class="row">
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">4</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">5</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">6</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta operator" id="cut">
                    <h2 class="h3">-</h2>
                </a></div>
        </div>
        <div class="row">
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">1</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">2</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">3</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta operator" id="add">
                    <h2 class="h3">+</h2>
                </a></div>
        </div>
        <div class="row">
            <div class="col my-2"><a class="btn btn-light bta" id="PN">
                    <h2 class="h3">+/-</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">0</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta btext">
                    <h2 class="h3">.</h2>
                </a></div>
            <div class="col my-2"><a class="btn btn-light bta" id="entercul">
                    <h2 class="h3">=</h2>
                </a></div>
        </div>

        <div class="mt-5">
            <h3 class="h5">歷程記錄</h3>
            <ul id="history" class="list-group">

            </ul>
        </div>

    </div>

    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>


    <script>
        var input = $("#cul-read");
        var STinput = $("#ST");
        var culanswer = 0;
        var recevalue = 0;
        var switchA = "";
        var switchB = "";
        var restartA = "canin";
        var restartB = "noch";

        $("#dark-light").on('click', function () {
            if ($("#dark-light").text() == "Dark") {
                $("body")
                    .addClass("text-white bg-dark");
                $("#cul-read")
                    .removeClass("bg-light text-dark")
                    .addClass("bg-secondary text-light");
                $("a.btn")
                    .removeClass("btn-light")
                    .addClass("btn-secondary");
                $("#dark-light")
                    .removeClass("btn-light")
                    .addClass("btn-secondary");
                $(".list-group-item")
                    .addClass("bg-secondary");
                $("#dark-light").text("light");
            }
            else {
                $("body")
                    .removeClass("text-white bg-dark");
                $("#cul-read")
                    .removeClass("bg-secondary text-light")
                    .addClass("bg-light text-dark");
                $("a.btn")
                    .removeClass("btn-secondary")
                    .addClass("btn-light");
                $("#dark-light")
                    .removeClass("btn-secondary")
                    .addClass("btn-light");
                $(".list-group-item")
                    .removeClass("bg-secondary");
                $("#dark-light").text("Dark");
            }
        }
        );

        var inputButtons = $(".btext h2");
        //console.log(inputButtons.html());

        for (var i = 0; i < $(inputButtons).length; i++) {
            //console.log($(inputButtons[i]).text());
            $(inputButtons[i]).on('click', function () {
                var inputnum;
                inputnum = $(this).text();
                restard("canin");
                point(inputnum);
            }
            );
        }

        function point(inputnum) {
            //console.log(input.val()[input.val().length-1]);
            if ((inputnum == ".") && (input.val().indexOf(inputnum) != -1)) {
                input.val();
            }
            else if ((inputnum == ".") && (input.val().length == 0)) {
                input.val("0" + inputnum);
            }
            else if ((inputnum != ".") && (input.val().length == 1) && (input.val()[0]) == "0") {
                input.val(inputnum);
            }
            else {
                input.val(input.val() + inputnum);
            }
        }

        $("#delete").on('click', function () {
            var del = input.val();
            input.val("");
            for (var i = 0; i < del.length - 1; i++) {
                input.val(input.val() + del[i]);
            }
            if (input.val().length == 0) {
                input.val("0");
            }
        }
        );

        $("#clearInput").on('click', function () {
            STinput.text("");
            input.val("0");
            culanswer = 0;
            recevalue = 0;
            switchA = "";
            switchB = "";
        }
        );

        $(".operator").on('click', ASDF());

        function ASDF() {


            $("#add").on('click', function () {
                STtext("+");
            }
            );

            $("#cut").on('click', function () {
                STtext("-");
            }
            );

            $("#mul").on('click', function () {
                STtext("x");
            }
            );

            $("#divi").on('click', function () {
                STtext("/");
            }
            );
        }

        function STtext(bto) {
            var STEND;
            var STtext;
            recevalue = +input.val();
            STEND = STinput.text()[STinput.text().length - 1];

            if ((STEND == ("+") || STEND == ("-") || STEND == ("x") || STEND == ("/")) && (input.val() == "")) {
                STtext = STinput.text();
                STinput.text("");
                for (var i = 0; i < STtext.length - 1; i++) {
                    STinput.text(STinput.text() + STtext[i]);
                }
                STinput.text(STinput.text() + bto);
                input.val("");
                switched("", bto);
                recevalue = 0;
            }
            else {
                STinput.text(STinput.text() + recevalue + bto);
                input.val("");
                switched(switchB, bto);
                recevalue = 0;
            }
        }

        function switched(HJKL, QWER) {
            switchA = HJKL;
            switchB = QWER;

            switch (switchA) {
                case "+":
                    culanswer += recevalue;
                    //console.log(culanswer);
                    break;
                case "-":
                    culanswer -= recevalue;
                    //console.log(culanswer);
                    break;
                case "x":
                    culanswer *= recevalue;
                    //console.log(culanswer);
                    break;
                case "/":
                    culanswer /= recevalue;
                    //console.log(culanswer);
                    break;

                default:
                    culanswer += recevalue;
            }
        }

        $("#PC").on('click', function () {
            input.val(input.val() * 0.01);
            recevalue = input.val();
            //console.log(recevalue);
        }
        );

        $("#PN").on('click', function () {
            input.val(input.val() * -1);
            recevalue = input.val();
            //console.log(recevalue);
        }
        );

        $("#entercul").on('click', function () {
            recevalue = +input.val();
            //console.log(recevalue);
            switched(switchB, "");
            input.val(culanswer);
            restard("keep");
            STinput.text("");
            culanswer = 0;
            recevalue = 0;
            switchA = "";
            switchB = "";
        }
        );

        function restard(ABCD) {
            restartA = ABCD;

            switch (restartA + restartB) {
                case "keepnoch":
                    if (STinput.text().indexOf("+") !== -1 || STinput.text().indexOf("-") !== -1 || STinput.text().indexOf("x") !== -1 || STinput.text().indexOf("/") !== -1) {
                        STinput.text(STinput.text() + recevalue);
                        historyinput();
                        restartB = "donto";
                    }
                    break;
                case "keepdonto":
                    break;
                case "caninnoch":
                    break;
                case "canindonto":
                    input.val("0");
                    restartB = "noch";
                    break;
            }
        }

        function historyinput() {
            if ($("#dark-light").text() == "Dark") {
                $("<li></li>")
                    .addClass("list-group-item text-left")
                    .html(STinput.text() + "=" + culanswer)
                    .prependTo("#history");
            }
            else {
                $("<li></li>")
                    .addClass("list-group-item text-left bg-secondary")
                    .html(STinput.text() + "=" + culanswer)
                    .prependTo("#history");
            }
        }
        //console.log();

    </script>
</body>

</html>